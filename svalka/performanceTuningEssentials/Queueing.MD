Перед тем как начать что-либо оптимизировать, нужно остановиться на том, что определить понятия очереди, и как с этим работает компьютер.

Итак что же происходит с очередями? Для работы с любым потоком ифнормации компьютер использует очереди. Эти очереди похожи на те что встречаются в повседневной жизни, например очередь к кассе в продуктовом магазине. На компьютере фундаментально очередь имеет такой же смысл. Это последовательность ожидания, в которую данные приходят со случайной скоростью. И это то что очень важно понимать - скорость с которой приходят данные случайна и не может быть предсказана. В зависимости от характера входящих данных, могут потребоваться различные решения для очередей.

И вскоре мы увидим, что есть принципиальная разница между обработкой задержки и пропускной способностью

Как управлять задержкой

```
длина очереди = средняя частота прибытия * среднее время ожидания
```

Например, если в очереди на кассу в супермакете в одну минуту стало приходить в 2 раза больше клиентов, то длина начнет тоже увеличиваться

```
время ожидания = время обслуживания + время в очереди
```

время обслуживания - это время, которое процесс исполняется процессором
время в очереди - это время, которое процесс ждет в очереди на выполнение

Стабильность очереди важна. Если частота, с которой новые данные появляются может быть предсказана, то становится легче предсказать пропускную способность очереди.

Для оптимизации мы не можем воздействовать на частоту прихода. Но можем на время ожидания с помощью sysctl параметров


Пропускная способность.

Общая пропускная способность системы определяется самым медленным компонентом системы. Таким образом нет смысла оптимизировать работу ЦПУ или памяти если узким местом является жесткий диск.

Если x - это пропускная способновсть (число завершенных запросов за период времени),
а v - это общее число запросов к ресурсу, сделанное за измеряемый период, то можно записать

```
X(system) = X(resource)/V(resource)
```

то это позволит вычислить более менее предсказуемую пропускную способность. Смыслом настройки производительности такой системы является то, чтобы она была сбалансированной. Чтобы пропускную способновсть определял самый медленный компонент.
И если максимальная пропускная способность фиксирована, то общая пропускная способность может быть все-равно увеличена путем запросов к ресурсу. Например, добавив больше дисков. И это позволяет вам, учитывая некоторые границы, существующие в физической системе, в любом случае манипулировать производительностью. Мы вернемся к этому более подробно позже в этом курсе.
